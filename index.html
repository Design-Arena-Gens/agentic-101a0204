<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Raummoden Analyzer</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="app-header">
      <h1>Raummoden Analyzer</h1>
      <p>Interaktive Analyse von Raummoden, Subwoofer-Positionen und Frequenzgängen.</p>
    </header>
    <main class="layout">
      <aside class="controls-panel">
        <form id="room-form" autocomplete="off">
          <fieldset>
            <legend>Raumtyp</legend>
            <label class="switch">
              <input type="checkbox" id="toggle-l-shape" />
              <span class="slider"></span>
              <span class="label-text">L-förmiger Raum</span>
            </label>
          </fieldset>
          <fieldset>
            <legend>Grundraum (Segment A)</legend>
            <div class="field">
              <label for="length-a">Länge L<sub>a</sub> (m)</label>
              <input type="number" step="0.1" min="1" id="length-a" value="6.0" />
            </div>
            <div class="field">
              <label for="width-a">Breite W<sub>a</sub> (m)</label>
              <input type="number" step="0.1" min="1" id="width-a" value="4.5" />
            </div>
            <div class="field">
              <label for="height">Höhe H (m)</label>
              <input type="number" step="0.05" min="2" id="height" value="2.6" />
            </div>
          </fieldset>
          <fieldset id="segment-b-fieldset" class="hidden">
            <legend>Zusatzsegment (Segment B)</legend>
            <div class="field">
              <label for="length-b">Länge L<sub>b</sub> (m)</label>
              <input type="number" step="0.1" min="1" id="length-b" value="3.0" />
            </div>
            <div class="field">
              <label for="width-b">Breite W<sub>b</sub> (m)</label>
              <input type="number" step="0.1" min="1" id="width-b" value="2.5" />
            </div>
            <div class="field">
              <label for="orientation">Ausrichtung</label>
              <select id="orientation">
                <option value="x">An Längsseite (X)</option>
                <option value="y">An Breitseite (Y)</option>
              </select>
            </div>
          </fieldset>
          <fieldset>
            <legend>Ohrhöhe</legend>
            <div class="field">
              <label for="listener-height">Ohrhöhe (m)</label>
              <input type="number" step="0.05" min="0.8" max="1.5" id="listener-height" value="1.2" />
            </div>
          </fieldset>
          <fieldset>
            <legend>Subwoofer</legend>
            <button type="button" id="add-subwoofer">Subwoofer hinzufügen</button>
            <ul id="subwoofer-list"></ul>
          </fieldset>
          <fieldset>
            <legend>Export</legend>
            <button type="button" id="export-pdf">PDF-Bericht erstellen</button>
          </fieldset>
        </form>
      </aside>
      <section class="visualizations">
        <div class="viz-grid">
          <article class="viz-card">
            <header>
              <h2>2D Draufsicht</h2>
              <div class="viz-actions">
                <button type="button" id="reset-topview">Reset Ansicht</button>
              </div>
            </header>
            <canvas id="top-view-canvas" width="800" height="600"></canvas>
            <p class="hint">Drag &amp; Drop für Subwoofer. Tipp: Klicken Sie auf einen Punkt für die Frequenzanalyse.</p>
          </article>
          <article class="viz-card">
            <header>
              <h2>3D Raumansicht</h2>
            </header>
            <div id="three-container"></div>
            <p class="hint">Swipe / Pinch zum Navigieren.</p>
          </article>
          <article class="viz-card">
            <header>
              <h2>Schnittbild Ohrhöhe</h2>
              <div class="viz-actions">
                <label>Raster:
                  <select id="heatmap-resolution">
                    <option value="40">40×40</option>
                    <option value="60" selected>60×60</option>
                    <option value="80">80×80</option>
                  </select>
                </label>
              </div>
            </header>
            <canvas id="heatmap-canvas" width="600" height="400"></canvas>
            <p class="hint">Farbskala: Rot = hoher Pegel, Blau = niedriger Pegel.</p>
          </article>
          <article class="viz-card">
            <header>
              <h2>Frequenzgang 20-200 Hz</h2>
            </header>
            <div id="frequency-chart"></div>
            <p class="hint">Basis: Summation der Moden am Hörplatz.</p>
          </article>
        </div>
        <article class="viz-card modes-card">
          <header>
            <h2>Modenübersicht</h2>
          </header>
          <div id="mode-distribution"></div>
        </article>
      </section>
    </main>
    <footer class="app-footer">
      <span id="status-indicator">Bereit</span>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/plotly.js-dist@2.30.1/plotly.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script type="module" src="main.js"></script>
  </body>
</html>
